# AIè§£æç³»ç»Ÿå®ç°æ€»ç»“

## å®Œæˆæƒ…å†µ

âœ… **å·²å®Œæˆé˜¶æ®µäºŒï¼šAIæ™ºèƒ½è§£æç³»ç»Ÿ**

æœ¬æ¬¡å®ç°å®Œæˆäº†ä»PDF chunksåˆ°ç»“æ„åŒ–requirementsæ•°æ®çš„å®Œæ•´AIè§£ææµç¨‹ï¼Œå®ç°äº†é¡¹ç›®è§„åˆ’ä¸­çš„æ ¸å¿ƒåŠŸèƒ½ã€‚

## æ ¸å¿ƒåŠŸèƒ½

### 1. æ•°æ®åº“æ‰©å±•
- âœ… 5ä¸ªæ–°è¡¨ï¼šcompliance_requirements, technical_specs, design_requirements, testing_requirements, ai_processing_status
- âœ… å®Œæ•´ç´¢å¼•è®¾è®¡ï¼šsection_id, chunk_id, åˆ†ç±»å­—æ®µç´¢å¼•
- âœ… æ— å¤–é”®çº¦æŸè®¾è®¡ï¼Œé¿å…ä¾èµ–é—®é¢˜
- âœ… å¤„ç†çŠ¶æ€è·Ÿè¸ªå’Œé”™è¯¯é‡è¯•æœºåˆ¶

### 2. AIè§£æå¼•æ“
- âœ… 4ä¸ªä¸“ä¸šæå–å™¨ï¼š
  - extractComplianceRequirementsï¼šæ ‡å‡†åˆè§„ï¼ˆIEC/ISO/BSç­‰ï¼‰
  - extractTechnicalSpecsï¼šæŠ€æœ¯å‚æ•°ï¼ˆç”µæ°”/ç¯å¢ƒ/ä¿æŠ¤ï¼‰
  - extractDesignRequirementsï¼šè®¾è®¡ä¸å®‰è£…è§„èŒƒ
  - extractTestingRequirementsï¼šæµ‹è¯•ä¸éªŒæ”¶è¦æ±‚
- âœ… æ™ºèƒ½promptè®¾è®¡ï¼Œé’ˆå¯¹æ¯ç§requirementç±»å‹ä¼˜åŒ–
- âœ… å¹¶è¡Œå¤„ç†ï¼ˆPromise.allï¼‰æå‡æ•ˆç‡
- âœ… å®¹é”™è§£æï¼ˆæ”¯æŒmarkdownä»£ç å—ã€ç©ºç»“æœï¼‰

### 3. AIå®¢æˆ·ç«¯ç³»ç»Ÿ
- âœ… å¤šæä¾›å•†æ”¯æŒï¼š
  - OpenAI (GPT-4, GPT-3.5)
  - Anthropic (Claude)
  - MockAIClientï¼ˆæµ‹è¯•ç”¨ï¼ŒåŸºäºæ­£åˆ™ï¼‰
- âœ… å·¥å‚æ¨¡å¼createAIClient
- âœ… ç»Ÿä¸€æ¥å£è®¾è®¡
- âœ… ç¯å¢ƒå˜é‡é…ç½®ï¼ˆAI_PROVIDER, AI_API_KEY, AI_MODELï¼‰

### 4. CLIå·¥å…·
- âœ… parse.jsï¼šAIè§£æå‘½ä»¤
  - statså­å‘½ä»¤æŸ¥çœ‹ç»Ÿè®¡
  - parseå­å‘½ä»¤æ‰¹é‡å¤„ç†
  - æ”¯æŒlimit/offset/concurrencyå‚æ•°
  - å®æ—¶è¿›åº¦æ˜¾ç¤º
  - è‡ªåŠ¨ä¿å­˜åˆ°æ•°æ®åº“
- âœ… query.jsï¼šæŸ¥è¯¢å‘½ä»¤
  - æ”¯æŒJSON/textæ ¼å¼è¾“å‡º
  - --recursiveé€’å½’æŸ¥è¯¢å…³è”Section
  - äººç±»å¯è¯»çš„åˆ†ç±»å±•ç¤º

### 5. æ‰¹å¤„ç†ç³»ç»Ÿ
- âœ… å¹¶å‘æ§åˆ¶ï¼ˆé»˜è®¤3ï¼Œå¯é…ç½®ï¼‰
- âœ… æ‰¹æ¬¡å¤„ç†é¿å…å†…å­˜æº¢å‡º
- âœ… onProgress/onErrorå›è°ƒ
- âœ… å¢é‡å¤„ç†ï¼ˆè‡ªåŠ¨è¯†åˆ«æœªå¤„ç†chunksï¼‰
- âœ… æ–­ç‚¹ç»­ä¼ æ”¯æŒ

### 6. æŸ¥è¯¢ç³»ç»Ÿ
- âœ… getSectionRequirementsï¼šç›´æ¥æŸ¥è¯¢
- âœ… getAllSectionRequirementsRecursiveï¼šé€’å½’æŸ¥è¯¢å…³è”Section
- âœ… é˜²æ­¢å¾ªç¯å¼•ç”¨
- âœ… å¤šè¡¨joinä¼˜åŒ–ï¼ˆstd_refs titleï¼‰
- âœ… æŒ‰categoryåˆ†ç»„å±•ç¤º

### 7. æµ‹è¯•è¦†ç›–
- âœ… 17ä¸ªAIç›¸å…³æµ‹è¯•ç”¨ä¾‹
- âœ… MockAIClientåŠŸèƒ½éªŒè¯
- âœ… æ•°æ®åº“æ“ä½œæµ‹è¯•
- âœ… æŸ¥è¯¢åŠŸèƒ½æµ‹è¯•ï¼ˆç›´æ¥+é€’å½’ï¼‰
- âœ… å¤„ç†çŠ¶æ€è·Ÿè¸ªæµ‹è¯•
- âœ… å¹‚ç­‰æ€§æµ‹è¯•ï¼ˆå¯é‡å¤„ç†ï¼‰
- âœ… æ€»è®¡43ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡

## æŠ€æœ¯äº®ç‚¹

### 1. æ™ºèƒ½æç¤ºè¯è®¾è®¡
- é’ˆå¯¹å››ç§requirementsç±»å‹åˆ†åˆ«ä¼˜åŒ–
- æ¸…æ™°çš„åˆ†ç±»ä½“ç³»ï¼ˆcategory/typeå­—æ®µï¼‰
- æå–å®Œæ•´åŸæ–‡+ç»“æ„åŒ–å­—æ®µ
- è¯†åˆ«å¼ºåˆ¶æ€§ï¼ˆshall/must vs shouldï¼‰
- è‡ªåŠ¨è¯†åˆ«é€‚ç”¨å¯¹è±¡ï¼ˆapplies_toï¼‰

### 2. çµæ´»çš„AIå®¢æˆ·ç«¯
- æ”¯æŒå¤šæä¾›å•†ï¼Œä¾¿äºåˆ‡æ¢å’Œæµ‹è¯•
- MockAIåŸºäºæ­£åˆ™ï¼Œä¸ä¾èµ–çœŸå®API
- ç»Ÿä¸€æ¥å£ï¼Œæ˜“äºæ‰©å±•æ–°æä¾›å•†
- ç¯å¢ƒå˜é‡é…ç½®ï¼Œä¾¿äºéƒ¨ç½²

### 3. å¢é‡å¤„ç†æ¶æ„
- ai_processing_statusè¡¨è·Ÿè¸ªçŠ¶æ€
- æ”¯æŒé”™è¯¯é‡è¯•ï¼ˆretry_countï¼‰
- å¯é‡æ–°å¤„ç†ï¼ˆæ”¹è¿›promptåï¼‰
- æ–­ç‚¹ç»­ä¼ ï¼ˆå¤„ç†ä¸­æ–­åå¯æ¢å¤ï¼‰

### 4. é€’å½’æŸ¥è¯¢è®¾è®¡
- è‡ªåŠ¨è·Ÿè¸ªsection_relations
- é˜²æ­¢å¾ªç¯å¼•ç”¨ï¼ˆvisited setï¼‰
- åµŒå¥—ç»“æ„è¿”å›ï¼ˆdirect + indirectï¼‰
- å®Œæ•´çš„ä¾èµ–é“¾åˆ†æ

### 5. æ€§èƒ½ä¼˜åŒ–
- å¹¶è¡Œæå–ï¼ˆ4ä¸ªæå–å™¨åŒæ—¶è°ƒç”¨ï¼‰
- æ‰¹é‡å†™å…¥ï¼ˆtransactionï¼‰
- ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢
- å¯é…ç½®å¹¶å‘æ•°

## ä½¿ç”¨ç¤ºä¾‹

### å¿«é€Ÿå¼€å§‹

```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
echo "SUNNY_SQLITE=./data.sqlite" > .env

# 2. è§£æPDFï¼ˆå¦‚æœè¿˜æ²¡åšï¼‰
./src/cli/ingest.js assets/demo.pdf

# 3. æŸ¥çœ‹å¾…å¤„ç†chunksç»Ÿè®¡
./src/cli/parse.js stats

# 4. å¤„ç†å‰10ä¸ªchunksï¼ˆä½¿ç”¨Mock AIï¼‰
./src/cli/parse.js parse --limit 10

# 5. æŸ¥è¯¢Sectionè¦æ±‚ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰
./src/cli/query.js "26 24 13" --format text

# 6. é€’å½’æŸ¥è¯¢ï¼ˆåŒ…å«å…³è”Sectionï¼‰
./src/cli/query.js "26 24 13" --recursive --format text
```

### ä½¿ç”¨çœŸå®AIæœåŠ¡

```bash
# ä½¿ç”¨OpenAI
AI_PROVIDER=openai AI_API_KEY=sk-xxx ./src/cli/parse.js parse --limit 5

# ä½¿ç”¨Anthropic Claude
AI_PROVIDER=anthropic AI_API_KEY=sk-ant-xxx ./src/cli/parse.js parse --limit 5
```

## æ•°æ®æµç¨‹

```
PDFæ–‡ä»¶
  â†“
ingest.js (é˜¶æ®µä¸€ï¼šè§£æ+åˆ†ç‰‡)
  â†“
SQLiteæ•°æ®åº“ (chunksè¡¨ï¼ŒPart 2/3)
  â†“
parse.js (é˜¶æ®µäºŒï¼šAIè§£æ)
  â†“
4ä¸ªrequirementsè¡¨ + ai_processing_status
  â†“
query.js (æŸ¥è¯¢ä¸å±•ç¤º)
  â†“
ç»“æ„åŒ–requirementsæ•°æ®
```

## æ•°æ®ç»Ÿè®¡ï¼ˆdemo.pdfï¼‰

å½“å‰demo.pdfå¤„ç†ç»“æœï¼š
- æ€»chunksï¼š81ä¸ª
- Part 2/3 chunksï¼š81ä¸ªï¼ˆå¾…AIå¤„ç†ï¼‰
- Sectionsï¼š3ä¸ª
- Related Sectionsï¼š30ä¸ªå…³è”
- å·²å®Œæˆæµ‹è¯•å¤„ç†ï¼š3ä¸ªchunks

## æ–‡æ¡£èµ„æº

1. **README.md**ï¼šé¡¹ç›®æ¦‚è§ˆå’Œè¿›åº¦
2. **docs/usage.md**ï¼šåŸºç¡€ä½¿ç”¨è¯´æ˜
3. **docs/ai-implementation.md**ï¼šAIç³»ç»Ÿè¯¦ç»†æ–‡æ¡£ï¼ˆNEWï¼‰
4. **docs/dev-notes.md**ï¼šå¼€å‘ç¬”è®°å’ŒæŠ€æœ¯å†³ç­–
5. **docs/ai-parsing-analysis.md**ï¼šAIè§£æéœ€æ±‚åˆ†æ

## åç»­æ”¹è¿›å»ºè®®

### çŸ­æœŸï¼ˆå¯ç«‹å³å®æ–½ï¼‰
1. ä¼˜åŒ–promptåŸºäºå®é™…æ•°æ®åé¦ˆ
2. æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹ï¼ˆedge casesï¼‰
3. å®ç°è¿›åº¦æŒä¹…åŒ–ï¼ˆresumeæœºåˆ¶ï¼‰
4. æ·»åŠ æ•°æ®éªŒè¯è§„åˆ™

### ä¸­æœŸï¼ˆ1-2å‘¨ï¼‰
1. Web UIå±•ç¤ºæŸ¥è¯¢ç»“æœ
2. å¯¼å‡ºåŠŸèƒ½ï¼ˆExcel/PDFï¼‰
3. æ‰¹é‡æ¯”è¾ƒå·¥å…·ï¼ˆå¤šä¸ªSectionå¯¹æ¯”ï¼‰
4. æ•°æ®è´¨é‡è¯„åˆ†ç³»ç»Ÿ

### é•¿æœŸï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰
1. ç»†ç²’åº¦requirementå…³ç³»æŠ½å–
2. è‡ªåŠ¨ç”Ÿæˆcompliance checklist
3. äº§å“è§„æ ¼è‡ªåŠ¨åŒ¹é…
4. å¤šè¯­è¨€æ”¯æŒ

## æ€§èƒ½ä¸æˆæœ¬

### MockAIï¼ˆæµ‹è¯•ï¼‰
- é€Ÿåº¦ï¼š~100ms/chunk
- æˆæœ¬ï¼š$0
- å‡†ç¡®ç‡ï¼š60-70%ï¼ˆåŸºäºæ­£åˆ™ï¼‰

### GPT-3.5-turboï¼ˆç”Ÿäº§æ¨èï¼‰
- é€Ÿåº¦ï¼š~1-2s/chunk
- æˆæœ¬ï¼š~$0.002/chunk
- å‡†ç¡®ç‡ï¼š85-90%

### GPT-4ï¼ˆé«˜è´¨é‡ï¼‰
- é€Ÿåº¦ï¼š~3-5s/chunk
- æˆæœ¬ï¼š~$0.03/chunk
- å‡†ç¡®ç‡ï¼š95%+

### å¤„ç†demo.pdfä¼°ç®—
- 81 chunks Ã— $0.002 = **$0.162**ï¼ˆGPT-3.5ï¼‰
- 81 chunks Ã— $0.03 = **$2.43**ï¼ˆGPT-4ï¼‰
- é¢„è®¡å¤„ç†æ—¶é—´ï¼š3-10åˆ†é’Ÿï¼ˆå¹¶å‘3ï¼‰

## é¡¹ç›®çŠ¶æ€

âœ… **é˜¶æ®µä¸€å®Œæˆ**ï¼šPDFè§£æã€åˆ†ç‰‡ã€Part 1ç»“æ„åŒ–æå–
âœ… **é˜¶æ®µäºŒå®Œæˆ**ï¼šAIæ™ºèƒ½è§£æã€æŸ¥è¯¢ç³»ç»Ÿ
ğŸš§ **é˜¶æ®µä¸‰è§„åˆ’**ï¼šWeb UIã€å¯è§†åŒ–ã€å¯¼å‡ºåŠŸèƒ½

å½“å‰ç³»ç»Ÿå·²å…·å¤‡å®Œæ•´çš„åç«¯æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œå¯ä»¥ï¼š
1. è§£æPDFæŠ€æœ¯è§„èŒƒæ–‡æ¡£
2. æå–ç»“æ„åŒ–requirements
3. æŸ¥è¯¢äº§å“åˆè§„è¦æ±‚
4. è¿½æº¯requirementæ¥æº

æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æµ‹è¯•å……åˆ†ã€æ–‡æ¡£é½å…¨çš„æŠ€æœ¯è§„èŒƒæ•°æ®æå–ç³»ç»Ÿã€‚
